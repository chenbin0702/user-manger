import{_ as N,r as h,v as T,N as L,a as r,o as F,c as U,e as s,b as a,w as t,p as k,u as j,M as I,f as m,t as l,O as A}from"./index-58786321.js";import"./index-17409aec.js";import{u as b,w as X,F as q}from"./xlsx-01326c6b.js";const G={class:"order-analysis"},H={class:"header"},J={class:"actions"},K={class:"card-content"},P={class:"card-content"},Q={class:"card-content"},W={class:"card-content"},Y={__name:"OrderAnalysis",setup(Z){const x=h([]),R=[{text:"最近一周",value:()=>{const n=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,n]}},{text:"最近一月",value:()=>{const n=new Date,e=new Date;return e.setMonth(e.getMonth()-1),[e,n]}},{text:"最近三月",value:()=>{const n=new Date,e=new Date;return e.setMonth(e.getMonth()-3),[e,n]}}],f=h({totalOrders:3256,completedOrders:2890,conversionRate:88.7,averageOrderValue:2580.5}),y=h([{type:"设备租赁",count:1580,amount:458600,percentage:45.8,trend:12.5,description:"设备租赁订单"},{type:"培训课程",count:980,amount:296e3,percentage:29.6,trend:8.3,description:"培训课程订单"},{type:"保险服务",count:696,amount:158e3,percentage:15.8,trend:-3.2,description:"保险服务订单"}]),w=h(null),g=h(null);let c=null,i=null;const V=()=>{if(w.value){c=A(w.value);const n=Array.from({length:7},(e,_)=>{const v=new Date;return v.setDate(v.getDate()-_),v.toLocaleDateString()}).reverse();c.setOption({tooltip:{trigger:"axis"},xAxis:{type:"category",data:n},yAxis:{type:"value"},series:[{name:"订单数",type:"line",smooth:!0,data:[150,180,160,180,150,200,180]}]})}g.value&&(i=A(g.value),i.setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"50%",data:y.value.map(n=>({name:n.type,value:n.percentage})),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}))},M=()=>{try{const n=b.book_new(),e=b.json_to_sheet(y.value);b.book_append_sheet(n,e,"订单分析");const _=X(n,{bookType:"xlsx",type:"array"});q.saveAs(new Blob([_],{type:"application/octet-stream"}),"订单分析报告.xlsx"),k.success("导出成功")}catch{k.error("导出失败")}},S=()=>{D()},D=()=>{V()};T(()=>{D(),window.addEventListener("resize",C)}),L(()=>{window.removeEventListener("resize",C),c&&c.dispose(),i&&i.dispose()});const C=()=>{c&&c.resize(),i&&i.resize()};return(n,e)=>{const _=r("el-date-picker"),v=r("el-icon"),z=r("el-button"),d=r("el-card"),p=r("el-col"),O=r("el-row"),u=r("el-table-column"),B=r("el-tag"),E=r("el-table");return F(),U("div",G,[s("div",H,[e[2]||(e[2]=s("h2",null,"订单分析",-1)),s("div",J,[a(_,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=o=>x.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:R,onChange:S},null,8,["modelValue"]),a(z,{type:"primary",onClick:M},{default:t(()=>[a(v,null,{default:t(()=>[a(j(I))]),_:1}),e[1]||(e[1]=m("导出数据 "))]),_:1})])]),a(O,{gutter:20,class:"statistics-cards"},{default:t(()=>[a(p,{span:6},{default:t(()=>[a(d,{shadow:"hover"},{header:t(()=>e[3]||(e[3]=[s("div",{class:"card-header"},[s("span",null,"总订单数")],-1)])),default:t(()=>[s("div",K,l(f.value.totalOrders),1)]),_:1})]),_:1}),a(p,{span:6},{default:t(()=>[a(d,{shadow:"hover"},{header:t(()=>e[4]||(e[4]=[s("div",{class:"card-header"},[s("span",null,"完成订单")],-1)])),default:t(()=>[s("div",P,l(f.value.completedOrders),1)]),_:1})]),_:1}),a(p,{span:6},{default:t(()=>[a(d,{shadow:"hover"},{header:t(()=>e[5]||(e[5]=[s("div",{class:"card-header"},[s("span",null,"转化率")],-1)])),default:t(()=>[s("div",Q,l(f.value.conversionRate)+"%",1)]),_:1})]),_:1}),a(p,{span:6},{default:t(()=>[a(d,{shadow:"hover"},{header:t(()=>e[6]||(e[6]=[s("div",{class:"card-header"},[s("span",null,"客单价")],-1)])),default:t(()=>[s("div",W,"¥"+l(f.value.averageOrderValue),1)]),_:1})]),_:1})]),_:1}),a(O,{gutter:20,class:"chart-row"},{default:t(()=>[a(p,{span:12},{default:t(()=>[a(d,{class:"chart-card"},{header:t(()=>e[7]||(e[7]=[s("div",{class:"card-header"},[s("span",null,"订单趋势")],-1)])),default:t(()=>[s("div",{ref_key:"trendChartRef",ref:w,class:"chart"},null,512)]),_:1})]),_:1}),a(p,{span:12},{default:t(()=>[a(d,{class:"chart-card"},{header:t(()=>e[8]||(e[8]=[s("div",{class:"card-header"},[s("span",null,"订单类型分布")],-1)])),default:t(()=>[s("div",{ref_key:"typeChartRef",ref:g,class:"chart"},null,512)]),_:1})]),_:1})]),_:1}),a(d,{class:"analysis-card"},{header:t(()=>e[9]||(e[9]=[s("div",{class:"card-header"},[s("span",null,"订单分析")],-1)])),default:t(()=>[a(E,{data:y.value,style:{width:"100%"}},{default:t(()=>[a(u,{prop:"type",label:"订单类型",width:"150"}),a(u,{prop:"count",label:"订单数",width:"120"}),a(u,{prop:"amount",label:"订单金额",width:"150"},{default:t(({row:o})=>[m(" ¥"+l(o.amount),1)]),_:1}),a(u,{prop:"percentage",label:"占比",width:"120"},{default:t(({row:o})=>[m(l(o.percentage)+"% ",1)]),_:1}),a(u,{prop:"trend",label:"环比",width:"150"},{default:t(({row:o})=>[a(B,{type:o.trend>=0?"success":"danger"},{default:t(()=>[m(l(o.trend>=0?"+":"")+l(o.trend)+"% ",1)]),_:2},1032,["type"])]),_:1}),a(u,{prop:"description",label:"说明"})]),_:1},8,["data"])]),_:1})])}}},ae=N(Y,[["__scopeId","data-v-ce7a6858"]]);export{ae as default};
