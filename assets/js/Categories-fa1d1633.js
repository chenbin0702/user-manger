import{_ as Z,r as u,v as ee,a as s,x as te,o as B,c as le,e as v,b as t,w as a,y as ae,g as oe,u as $,s as ne,f as i,C as se,t as T,q as D,p as y}from"./index-58786321.js";import{I as ue}from"./index-8b71832c.js";const re={class:"article-categories"},ie={class:"header"},de={class:"actions"},ce={class:"search-bar"},pe={class:"category-name"},me={class:"pagination"},ve={class:"dialog-footer"},_e={__name:"Categories",setup(fe){const V=u([{id:1,name:"新闻资讯",code:"news",icon:"News",sort:1,articleCount:25,status:"启用",createTime:"2024-01-20 10:00:00",children:[{id:11,name:"行业动态",code:"news_industry",icon:"Trend",sort:1,articleCount:15,status:"启用",createTime:"2024-01-20 10:30:00"},{id:12,name:"政策解读",code:"news_policy",icon:"Document",sort:2,articleCount:10,status:"启用",createTime:"2024-01-20 11:00:00"}]},{id:2,name:"技术文章",code:"tech",icon:"Monitor",sort:2,articleCount:18,status:"启用",createTime:"2024-01-20 12:00:00"}]),r=u({keyword:"",status:""}),b=u(1),h=u(10),U=u(0),w=u(!1),_=u(!1),C=u(!1),k=u(null),n=u({parentId:null,name:"",code:"",icon:"",sort:0,status:"启用",description:""}),I={name:[{required:!0,message:"请输入分类名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入分类编码",trigger:"blur"},{pattern:/^[a-z][a-z0-9_]*$/,message:"编码只能包含小写字母、数字和下划线，且必须以字母开头",trigger:"blur"}],sort:[{required:!0,message:"请输入排序号",trigger:"blur"}]},x=()=>{b.value=1,f()},E=()=>{r.value={keyword:"",status:""},x()},q=o=>{h.value=o,f()},L=o=>{b.value=o,f()},M=()=>{C.value=!1,n.value={parentId:null,name:"",code:"",icon:"",sort:0,status:"启用",description:""},_.value=!0},N=o=>{C.value=!0,n.value={...o},_.value=!0},P=o=>{const e=o.status==="启用"?"禁用":"启用";D.confirm(`确定要${e}分类"${o.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.status=o.status==="启用"?"禁用":"启用",y.success(`${e}成功`)})},R=o=>{var e;if((e=o.children)!=null&&e.length){y.warning("请先删除子分类");return}if(o.articleCount>0){y.warning("该分类下还有文章，不能删除");return}D.confirm(`确定要删除分类"${o.name}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y.success("删除成功"),f()})},j=async()=>{k.value&&await k.value.validate(o=>{o&&(y.success(C.value?"更新成功":"创建成功"),_.value=!1,f())})},f=()=>{w.value=!0;try{setTimeout(()=>{const o=V.value.filter(e=>{const p=!r.value.keyword||e.name.toLowerCase().includes(r.value.keyword.toLowerCase())||e.code.toLowerCase().includes(r.value.keyword.toLowerCase()),g=!r.value.status||e.status===r.value.status;return p&&g});U.value=o.length,w.value=!1},300)}finally{w.value=!1}},A=u([{id:0,label:"顶级分类",children:V.value.map(o=>{var e;return{id:o.id,label:o.name,children:(e=o.children)==null?void 0:e.map(p=>({id:p.id,label:p.name}))}})}]);return ee(()=>{f()}),(o,e)=>{const p=s("el-icon"),g=s("el-input"),S=s("el-option"),F=s("el-select"),d=s("el-button"),c=s("el-table-column"),K=s("el-tag"),G=s("el-table"),H=s("el-pagination"),J=s("el-tree-select"),m=s("el-form-item"),O=s("el-input-number"),Q=s("el-switch"),W=s("el-form"),X=s("el-dialog"),Y=te("loading");return B(),le("div",re,[v("div",ie,[e[16]||(e[16]=v("h2",null,"文章分类管理",-1)),v("div",de,[v("div",ce,[t(g,{modelValue:r.value.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value.keyword=l),placeholder:"搜索分类名称/编码",clearable:"",onClear:x,class:"search-input"},{prefix:a(()=>[t(p,null,{default:a(()=>[t($(ne))]),_:1})]),_:1},8,["modelValue"]),t(F,{modelValue:r.value.status,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value.status=l),placeholder:"状态",clearable:"",class:"search-select"},{default:a(()=>[t(S,{label:"启用",value:"启用"}),t(S,{label:"禁用",value:"禁用"})]),_:1},8,["modelValue"]),t(d,{type:"primary",onClick:x},{default:a(()=>e[13]||(e[13]=[i("搜索")])),_:1}),t(d,{onClick:E},{default:a(()=>e[14]||(e[14]=[i("重置")])),_:1})]),t(d,{type:"primary",onClick:M},{default:a(()=>[t(p,null,{default:a(()=>[t($(se))]),_:1}),e[15]||(e[15]=i("新增分类 "))]),_:1})])]),ae((B(),oe(G,{data:V.value,style:{width:"100%"},border:"","row-key":"id","tree-props":{children:"children"}},{default:a(()=>[t(c,{prop:"id",label:"序号",width:"100",align:"center"}),t(c,{prop:"name",label:"分类名称","min-width":"200","show-overflow-tooltip":""},{default:a(({row:l})=>[v("span",pe,T(l.name),1)]),_:1}),t(c,{prop:"code",label:"分类编码","min-width":"150","show-overflow-tooltip":""}),t(c,{prop:"sort",label:"排序",width:"100",align:"center"}),t(c,{prop:"articleCount",label:"文章数量",width:"100",align:"center"}),t(c,{prop:"status",label:"状态",width:"100"},{default:a(({row:l})=>[t(K,{type:l.status==="启用"?"success":"info"},{default:a(()=>[i(T(l.status),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"createTime",label:"创建时间",width:"180"}),t(c,{label:"操作",width:"250",fixed:"right"},{default:a(({row:l})=>[t(d,{link:"",type:"primary",onClick:z=>N(l)},{default:a(()=>e[17]||(e[17]=[i("编辑")])),_:2},1032,["onClick"]),t(d,{link:"",type:l.status==="启用"?"warning":"success",onClick:z=>P(l)},{default:a(()=>[i(T(l.status==="启用"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),t(d,{link:"",type:"danger",onClick:z=>R(l)},{default:a(()=>e[18]||(e[18]=[i(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Y,w.value]]),v("div",me,[t(H,{"current-page":b.value,"onUpdate:currentPage":e[2]||(e[2]=l=>b.value=l),"page-size":h.value,"onUpdate:pageSize":e[3]||(e[3]=l=>h.value=l),"page-sizes":[10,20,50,100],total:U.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:L},null,8,["current-page","page-size","total"])]),t(X,{modelValue:_.value,"onUpdate:modelValue":e[12]||(e[12]=l=>_.value=l),title:C.value?"编辑分类":"新增分类",width:"500px"},{footer:a(()=>[v("span",ve,[t(d,{onClick:e[11]||(e[11]=l=>_.value=!1)},{default:a(()=>e[19]||(e[19]=[i("取消")])),_:1}),t(d,{type:"primary",onClick:j},{default:a(()=>e[20]||(e[20]=[i("确定")])),_:1})])]),default:a(()=>[t(W,{ref_key:"formRef",ref:k,model:n.value,rules:I,"label-width":"100px"},{default:a(()=>[t(m,{label:"上级分类"},{default:a(()=>[t(J,{modelValue:n.value.parentId,"onUpdate:modelValue":e[4]||(e[4]=l=>n.value.parentId=l),data:A.value,placeholder:"请选择上级分类","check-strictly":"","render-after-expand":!1,style:{width:"100%"}},null,8,["modelValue","data"])]),_:1}),t(m,{label:"分类名称",prop:"name"},{default:a(()=>[t(g,{modelValue:n.value.name,"onUpdate:modelValue":e[5]||(e[5]=l=>n.value.name=l),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),t(m,{label:"分类编码",prop:"code"},{default:a(()=>[t(g,{modelValue:n.value.code,"onUpdate:modelValue":e[6]||(e[6]=l=>n.value.code=l),placeholder:"请输入分类编码"},null,8,["modelValue"])]),_:1}),t(m,{label:"图标",prop:"icon"},{default:a(()=>[t(ue,{modelValue:n.value.icon,"onUpdate:modelValue":e[7]||(e[7]=l=>n.value.icon=l)},null,8,["modelValue"])]),_:1}),t(m,{label:"排序",prop:"sort"},{default:a(()=>[t(O,{modelValue:n.value.sort,"onUpdate:modelValue":e[8]||(e[8]=l=>n.value.sort=l),min:0,max:99,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(m,{label:"状态"},{default:a(()=>[t(Q,{modelValue:n.value.status,"onUpdate:modelValue":e[9]||(e[9]=l=>n.value.status=l),"active-value":"启用","inactive-value":"禁用"},null,8,["modelValue"])]),_:1}),t(m,{label:"描述"},{default:a(()=>[t(g,{modelValue:n.value.description,"onUpdate:modelValue":e[10]||(e[10]=l=>n.value.description=l),type:"textarea",rows:3,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},be=Z(_e,[["__scopeId","data-v-a7483e06"]]);export{be as default};
