import{_ as L,r as h,v as F,N as U,a as r,o as Y,c as j,e as s,b as a,w as t,p as S,u as m,M as I,f as w,t as l,O}from"./index-58786321.js";import"./index-17409aec.js";import{u as x,w as X,F as q}from"./xlsx-01326c6b.js";import{f as D}from"./format-44ea9176.js";const G={class:"revenue-statistics"},H={class:"header"},J={class:"actions"},K={class:"card-content"},P={class:"card-content"},Q={class:"card-content"},W={class:"card-content"},Z={__name:"RevenueStatistics",setup($){const C=h([]),V=[{text:"最近一周",value:()=>{const n=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,n]}},{text:"最近一月",value:()=>{const n=new Date,e=new Date;return e.setMonth(e.getMonth()-1),[e,n]}},{text:"最近三月",value:()=>{const n=new Date,e=new Date;return e.setMonth(e.getMonth()-3),[e,n]}}],f=h({totalRevenue:1258600,monthlyRevenue:298600,yearOverYear:25.8,monthOverMonth:12.5}),g=h([{source:"设备租赁",amount:458600,percentage:45.8,trend:12.5,description:"设备租赁收入"},{source:"培训课程",amount:296e3,percentage:29.6,trend:8.3,description:"培训课程收入"},{source:"保险服务",amount:158e3,percentage:15.8,trend:-3.2,description:"保险服务收入"}]),y=h(null),b=h(null);let c=null,i=null;const z=()=>{if(y.value){c=O(y.value);const n=Array.from({length:7},(e,p)=>{const _=new Date;return _.setDate(_.getDate()-p),_.toLocaleDateString()}).reverse();c.setOption({tooltip:{trigger:"axis"},xAxis:{type:"category",data:n},yAxis:{type:"value"},series:[{name:"收入",type:"line",smooth:!0,data:[15e4,18e4,16e4,18e4,15e4,2e5,18e4]}]})}b.value&&(i=O(b.value),i.setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"50%",data:g.value.map(n=>({name:n.source,value:n.percentage})),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}))},A=()=>{try{const n=x.book_new(),e=x.json_to_sheet(g.value);x.book_append_sheet(n,e,"收入统计");const p=X(n,{bookType:"xlsx",type:"array"});q.saveAs(new Blob([p],{type:"application/octet-stream"}),"收入统计报告.xlsx"),S.success("导出成功")}catch{S.error("导出失败")}},B=()=>{R()},R=()=>{z()};F(()=>{R(),window.addEventListener("resize",k)}),U(()=>{window.removeEventListener("resize",k),c&&c.dispose(),i&&i.dispose()});const k=()=>{c&&c.resize(),i&&i.resize()};return(n,e)=>{const p=r("el-date-picker"),_=r("el-icon"),E=r("el-button"),d=r("el-card"),u=r("el-col"),M=r("el-row"),v=r("el-table-column"),N=r("el-tag"),T=r("el-table");return Y(),j("div",G,[s("div",H,[e[2]||(e[2]=s("h2",null,"收入统计",-1)),s("div",J,[a(p,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=o=>C.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:V,onChange:B},null,8,["modelValue"]),a(E,{type:"primary",onClick:A},{default:t(()=>[a(_,null,{default:t(()=>[a(m(I))]),_:1}),e[1]||(e[1]=w("导出数据 "))]),_:1})])]),a(M,{gutter:20,class:"statistics-cards"},{default:t(()=>[a(u,{span:6},{default:t(()=>[a(d,{shadow:"hover"},{header:t(()=>e[3]||(e[3]=[s("div",{class:"card-header"},[s("span",null,"总收入")],-1)])),default:t(()=>[s("div",K,"¥"+l(m(D)(f.value.totalRevenue)),1)]),_:1})]),_:1}),a(u,{span:6},{default:t(()=>[a(d,{shadow:"hover"},{header:t(()=>e[4]||(e[4]=[s("div",{class:"card-header"},[s("span",null,"本月收入")],-1)])),default:t(()=>[s("div",P,"¥"+l(m(D)(f.value.monthlyRevenue)),1)]),_:1})]),_:1}),a(u,{span:6},{default:t(()=>[a(d,{shadow:"hover"},{header:t(()=>e[5]||(e[5]=[s("div",{class:"card-header"},[s("span",null,"同比增长")],-1)])),default:t(()=>[s("div",Q,l(f.value.yearOverYear)+"%",1)]),_:1})]),_:1}),a(u,{span:6},{default:t(()=>[a(d,{shadow:"hover"},{header:t(()=>e[6]||(e[6]=[s("div",{class:"card-header"},[s("span",null,"环比增长")],-1)])),default:t(()=>[s("div",W,l(f.value.monthOverMonth)+"%",1)]),_:1})]),_:1})]),_:1}),a(M,{gutter:20,class:"chart-row"},{default:t(()=>[a(u,{span:12},{default:t(()=>[a(d,{class:"chart-card"},{header:t(()=>e[7]||(e[7]=[s("div",{class:"card-header"},[s("span",null,"收入趋势")],-1)])),default:t(()=>[s("div",{ref_key:"trendChartRef",ref:y,class:"chart"},null,512)]),_:1})]),_:1}),a(u,{span:12},{default:t(()=>[a(d,{class:"chart-card"},{header:t(()=>e[8]||(e[8]=[s("div",{class:"card-header"},[s("span",null,"收入构成")],-1)])),default:t(()=>[s("div",{ref_key:"compositionChartRef",ref:b,class:"chart"},null,512)]),_:1})]),_:1})]),_:1}),a(d,{class:"details-card"},{header:t(()=>e[9]||(e[9]=[s("div",{class:"card-header"},[s("span",null,"收入明细")],-1)])),default:t(()=>[a(T,{data:g.value,style:{width:"100%"}},{default:t(()=>[a(v,{prop:"source",label:"收入来源",width:"150"}),a(v,{prop:"amount",label:"金额",width:"150"},{default:t(({row:o})=>[w(" ¥"+l(m(D)(o.amount)),1)]),_:1}),a(v,{prop:"percentage",label:"占比",width:"120"},{default:t(({row:o})=>[w(l(o.percentage)+"% ",1)]),_:1}),a(v,{prop:"trend",label:"环比",width:"150"},{default:t(({row:o})=>[a(N,{type:o.trend>=0?"success":"danger"},{default:t(()=>[w(l(o.trend>=0?"+":"")+l(o.trend)+"% ",1)]),_:2},1032,["type"])]),_:1}),a(v,{prop:"description",label:"说明"})]),_:1},8,["data"])]),_:1})])}}},ne=L(Z,[["__scopeId","data-v-617ab803"]]);export{ne as default};
