import{_ as N,r as O,a as c,o as z,c as T,b as e,w as s,e as a,u as y,G,f as i,H,t as p,j as I,I as J,J as Q,k as R,K as W,F as X,d as Y,n as Z,m as P,x as ee,s as te,L as se,y as ae,g as q,q as le,v as oe,p as U,M as ne}from"./index-58786321.js";import{f as B}from"./format-44ea9176.js";import{o as F}from"./orderService-27a58aea.js";const ie={class:"statistics-section"},de={class:"card-header"},re={class:"header-title"},ue={class:"statistics-content"},ce={class:"overview-row"},_e={class:"statistics-item"},pe={class:"item-icon primary"},me={class:"item-content"},ve={class:"item-value primary"},ge={class:"item-trend"},be={class:"trend-value up"},fe={class:"statistics-item"},ye={class:"item-icon success"},Ce={class:"item-content"},he={class:"item-value success"},we={class:"item-trend"},Oe={class:"trend-value up"},De={class:"statistics-item"},xe={class:"item-icon info"},Se={class:"item-content"},ke={class:"item-value info"},ze={class:"item-trend"},Ve={class:"trend-value down"},Te={class:"distribution-row"},$e={class:"statistics-item"},Be={class:"distribution-section"},Ne={class:"section-header"},Ue={class:"item-icon warning"},Fe={class:"distribution"},Pe={class:"progress-label"},Ee={class:"progress-value"},Me={class:"progress-info"},Ae={class:"progress-label"},Ie={class:"progress-details"},qe={class:"detail-item"},je={class:"detail-item"},Ke={__name:"OrderStatistics",props:{statistics:{type:Object,required:!0}},emits:["period-change"],setup(o,{emit:D}){const w=D,b=O("day"),v=d=>{var n,_;const t={设备租赁:{color:"#FF6B6B",background:"rgba(255,107,107,.1)"},培训课程:{color:"#4B9EFF",background:"rgba(75,158,255,.1)"},保险服务:{color:"#4CD964",background:"rgba(76,217,100,.1)"},其他:{color:"#FFAF36",background:"rgba(255,175,54,.1)"}};return console.log("first",(n=t[d])==null?void 0:n.color),((_=t[d])==null?void 0:_.color)||t.其他.color},h=d=>{w("period-change",d)};return(d,t)=>{const n=c("el-icon"),_=c("el-radio-button"),C=c("el-tooltip"),x=c("el-radio-group"),V=c("el-progress"),l=c("el-card");return z(),T("div",ie,[e(l,{shadow:"hover",class:"statistics-card"},{header:s(()=>[a("div",de,[a("div",re,[e(n,null,{default:s(()=>[e(y(G))]),_:1}),t[1]||(t[1]=a("span",null,"订单数据概览",-1))]),e(x,{modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=m=>b.value=m),onChange:h},{default:s(()=>[e(C,{content:"按日统计",placement:"top"},{default:s(()=>[e(_,{label:"day"},{default:s(()=>t[2]||(t[2]=[i("日")])),_:1})]),_:1}),e(C,{content:"按周统计",placement:"top"},{default:s(()=>[e(_,{label:"week"},{default:s(()=>t[3]||(t[3]=[i("周")])),_:1})]),_:1}),e(C,{content:"按月统计",placement:"top"},{default:s(()=>[e(_,{label:"month"},{default:s(()=>t[4]||(t[4]=[i("月")])),_:1})]),_:1}),e(C,{content:"按年统计",placement:"top"},{default:s(()=>[e(_,{label:"year"},{default:s(()=>t[5]||(t[5]=[i("年")])),_:1})]),_:1})]),_:1},8,["modelValue"])])]),default:s(()=>[a("div",ue,[a("div",ce,[a("div",_e,[a("div",pe,[e(n,null,{default:s(()=>[e(y(H))]),_:1})]),a("div",me,[t[8]||(t[8]=a("div",{class:"item-label"},"总订单数",-1)),a("div",ve,p(o.statistics.totalOrders),1),a("div",ge,[t[7]||(t[7]=a("span",{class:"trend-label"},"较上期",-1)),a("span",be,[e(n,null,{default:s(()=>[e(y(I))]),_:1}),t[6]||(t[6]=i("12.5% "))])])])]),a("div",fe,[a("div",ye,[e(n,null,{default:s(()=>[e(y(J))]),_:1})]),a("div",Ce,[t[11]||(t[11]=a("div",{class:"item-label"},"总金额",-1)),a("div",he,"¥"+p(y(B)(o.statistics.totalAmount)),1),a("div",we,[t[10]||(t[10]=a("span",{class:"trend-label"},"较上期",-1)),a("span",Oe,[e(n,null,{default:s(()=>[e(y(I))]),_:1}),t[9]||(t[9]=i("8.3% "))])])])]),a("div",De,[a("div",xe,[e(n,null,{default:s(()=>[e(y(Q))]),_:1})]),a("div",Se,[t[14]||(t[14]=a("div",{class:"item-label"},"平均客单价",-1)),a("div",ke,"¥"+p(y(B)(o.statistics.totalAmount/o.statistics.totalOrders)),1),a("div",ze,[t[13]||(t[13]=a("span",{class:"trend-label"},"较上期",-1)),a("span",Ve,[e(n,null,{default:s(()=>[e(y(R))]),_:1}),t[12]||(t[12]=i("3.2% "))])])])])]),a("div",Te,[a("div",$e,[a("div",Be,[a("div",Ne,[a("div",Ue,[e(n,null,{default:s(()=>[e(y(W))]),_:1})]),t[15]||(t[15]=a("div",{class:"item-label"},"订单分布",-1))]),a("div",Fe,[(z(!0),T(X,null,Y(o.statistics.typeDistribution,m=>(z(),T("div",{key:m.type,class:"distribution-item"},[e(V,{percentage:m.value,"stroke-width":8,color:v(m.type),"show-text":!1},{default:s(({percentage:$})=>[a("span",Pe,p(m.type),1),a("span",Ee,p($)+"%",1)]),_:2},1032,["percentage","color"]),a("div",Me,[a("span",Ae,p(m.type),1),a("div",Ie,[a("span",qe,"订单数: "+p(Math.floor(o.statistics.totalOrders*m.value/100)),1),a("span",je,"金额: ¥"+p(y(B)(o.statistics.totalAmount*m.value/100)),1),a("span",{class:"progress-value",style:Z({color:v(m.type)})},p(m.value)+"% ",5)])])]))),128))])])])])])]),_:1})])}}},Le=N(Ke,[["__scopeId","data-v-df3575ca"]]);const Ge={class:"order-tabs"},He={__name:"OrderTabs",props:{orderCounts:{type:Object,required:!0},activeStatus:{type:String,default:""}},emits:["update:active-status"],setup(o,{emit:D}){const w=o,b=D,v=P({get:()=>w.activeStatus,set:d=>b("update:active-status",d)}),h=d=>{v.value=d.props.name};return(d,t)=>{const n=c("el-badge"),_=c("el-tab-pane"),C=c("el-tabs");return z(),T("div",Ge,[e(C,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=x=>v.value=x),onTabClick:h},{default:s(()=>[e(_,{label:"全部订单",name:""},{label:s(()=>[t[1]||(t[1]=i(" 全部订单 ")),e(n,{value:o.orderCounts.all},null,8,["value"])]),_:1}),e(_,{name:"pending"},{label:s(()=>[t[2]||(t[2]=i(" 待付款 ")),e(n,{value:o.orderCounts.pending,type:"warning"},null,8,["value"])]),_:1}),e(_,{name:"processing"},{label:s(()=>[t[3]||(t[3]=i(" 进行中 ")),e(n,{value:o.orderCounts.processing,type:"primary"},null,8,["value"])]),_:1}),e(_,{name:"completed"},{label:s(()=>[t[4]||(t[4]=i(" 已完成 ")),e(n,{value:o.orderCounts.completed,type:"success"},null,8,["value"])]),_:1}),e(_,{name:"cancelled"},{label:s(()=>[t[5]||(t[5]=i(" 已取消 ")),e(n,{value:o.orderCounts.cancelled,type:"info"},null,8,["value"])]),_:1})]),_:1},8,["modelValue"])])}}},Je=N(He,[["__scopeId","data-v-ea843284"]]);const Qe={class:"order-table"},Re={class:"table-header"},We={__name:"OrderTable",props:{loading:Boolean,orders:{type:Array,required:!0},total:{type:Number,required:!0},page:{type:Number,default:1},pageSize:{type:Number,default:10}},emits:["update:page","update:page-size","view","edit","delete"],setup(o,{emit:D}){const w=o,b=D,v=O(""),h=P({get:()=>w.page,set:r=>b("update:page",r)}),d=P({get:()=>w.pageSize,set:r=>b("update:page-size",r)}),t=r=>({待付款:"warning",进行中:"primary",已完成:"success",已取消:"info"})[r]||"info",n=r=>["待付款","进行中"].includes(r.status),_=r=>["待付款","已取消"].includes(r.status),C=()=>{h.value=1},x=r=>{b("view",r)},V=r=>{b("edit",r)},l=r=>{le.confirm(`确定要删除订单 ${r.orderNo} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{b("delete",r)})},m=r=>{d.value=r},$=r=>{h.value=r};return(r,u)=>{const g=c("el-icon"),E=c("el-input"),S=c("el-table-column"),k=c("el-tag"),M=c("el-button"),j=c("el-table"),K=c("el-pagination"),L=ee("loading");return z(),T("div",Qe,[a("div",Re,[e(E,{modelValue:v.value,"onUpdate:modelValue":u[0]||(u[0]=f=>v.value=f),placeholder:"搜索订单号/客户信息",class:"search-input",clearable:"",onClear:C,onKeyup:se(C,["enter"])},{prefix:s(()=>[e(g,null,{default:s(()=>[e(y(te))]),_:1})]),_:1},8,["modelValue"])]),ae((z(),q(j,{data:o.orders,style:{width:"100%"}},{default:s(()=>[e(S,{prop:"orderNo",label:"订单编号",width:"120",sortable:""}),e(S,{prop:"type",label:"订单类型",width:"120"}),e(S,{prop:"customerName",label:"客户姓名",width:"120"}),e(S,{prop:"amount",label:"订单金额",width:"120"},{default:s(({row:f})=>[i(" ¥"+p(y(B)(f.amount)),1)]),_:1}),e(S,{prop:"status",label:"订单状态",width:"100"},{default:s(({row:f})=>[e(k,{type:t(f.status)},{default:s(()=>[i(p(f.status),1)]),_:2},1032,["type"])]),_:1}),e(S,{prop:"createTime",label:"创建时间",width:"180",sortable:""}),e(S,{label:"操作",width:"200",fixed:"right"},{default:s(({row:f})=>[e(M,{size:"small",onClick:A=>x(f)},{default:s(()=>u[3]||(u[3]=[i("查看")])),_:2},1032,["onClick"]),e(M,{size:"small",type:"primary",onClick:A=>V(f),disabled:!n(f)},{default:s(()=>u[4]||(u[4]=[i(" 编辑 ")])),_:2},1032,["onClick","disabled"]),e(M,{size:"small",type:"danger",onClick:A=>l(f),disabled:!_(f)},{default:s(()=>u[5]||(u[5]=[i(" 删除 ")])),_:2},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[L,o.loading]]),e(K,{"current-page":h.value,"onUpdate:currentPage":u[1]||(u[1]=f=>h.value=f),"page-size":d.value,"onUpdate:pageSize":u[2]||(u[2]=f=>d.value=f),total:o.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",class:"pagination",onSizeChange:m,onCurrentChange:$},null,8,["current-page","page-size","total"])])}}},Xe=N(We,[["__scopeId","data-v-bb8ff63f"]]);const Ye={class:"dialog-footer"},Ze={__name:"OrderDetail",props:{visible:Boolean,orderData:{type:Object,default:()=>null}},emits:["update:visible"],setup(o,{emit:D}){const w=o,b=D,v=P({get:()=>w.visible,set:d=>b("update:visible",d)}),h=d=>({待付款:"warning",进行中:"primary",已完成:"success",已取消:"info"})[d]||"info";return(d,t)=>{const n=c("el-descriptions-item"),_=c("el-tag"),C=c("el-descriptions"),x=c("el-button"),V=c("el-dialog");return z(),q(V,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=l=>v.value=l),title:"订单详情",width:"800px"},{footer:s(()=>[a("span",Ye,[e(x,{onClick:t[0]||(t[0]=l=>v.value=!1)},{default:s(()=>t[2]||(t[2]=[i("关闭")])),_:1})])]),default:s(()=>[e(C,{column:2,border:""},{default:s(()=>[e(n,{label:"订单编号"},{default:s(()=>{var l;return[i(p((l=o.orderData)==null?void 0:l.orderNo),1)]}),_:1}),e(n,{label:"订单类型"},{default:s(()=>{var l;return[i(p((l=o.orderData)==null?void 0:l.type),1)]}),_:1}),e(n,{label:"客户姓名"},{default:s(()=>{var l;return[i(p((l=o.orderData)==null?void 0:l.customerName),1)]}),_:1}),e(n,{label:"联系电话"},{default:s(()=>{var l;return[i(p((l=o.orderData)==null?void 0:l.customerPhone),1)]}),_:1}),e(n,{label:"订单金额"},{default:s(()=>{var l;return[i(" ¥"+p(y(B)(((l=o.orderData)==null?void 0:l.amount)||0)),1)]}),_:1}),e(n,{label:"订单状态"},{default:s(()=>{var l;return[e(_,{type:h((l=o.orderData)==null?void 0:l.status)},{default:s(()=>{var m;return[i(p((m=o.orderData)==null?void 0:m.status),1)]}),_:1},8,["type"])]}),_:1}),e(n,{label:"创建时间"},{default:s(()=>{var l;return[i(p((l=o.orderData)==null?void 0:l.createTime),1)]}),_:1}),e(n,{label:"更新时间"},{default:s(()=>{var l;return[i(p((l=o.orderData)==null?void 0:l.updateTime),1)]}),_:1}),e(n,{label:"备注",span:2},{default:s(()=>{var l;return[i(p(((l=o.orderData)==null?void 0:l.remarks)||"无"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}},et=N(Ze,[["__scopeId","data-v-085373b0"]]);const tt={class:"order-management"},st={class:"header"},at={class:"actions"},lt={__name:"OrderManagement",setup(o){const D=O(!1),w=O(""),b=O(1),v=O(10),h=O(0),d=O(!1),t=O(null),n=O({totalOrders:0,totalAmount:0,typeDistribution:[]}),_=O({all:0,pending:0,processing:0,completed:0,cancelled:0}),C=O([]),x=async()=>{D.value=!0;try{const{orders:u,total:g}=await F.getOrders({page:b.value,pageSize:v.value,status:w.value});C.value=u,h.value=g,n.value=await F.getStatistics(),_.value=await F.getOrderCounts()}catch{U.error("加载数据失败")}finally{D.value=!1}},V=u=>{x()},l=u=>{t.value=u,d.value=!0},m=u=>{},$=async u=>{try{await F.deleteOrder(u.id),U.success("删除成功"),x()}catch{U.error("删除失败")}},r=()=>{U.success("数据导出成功")};return oe(()=>{x()}),(u,g)=>{const E=c("el-icon"),S=c("el-button");return z(),T("div",tt,[a("div",st,[g[5]||(g[5]=a("h2",null,"订单管理",-1)),a("div",at,[e(S,{type:"primary",onClick:r},{default:s(()=>[e(E,null,{default:s(()=>[e(y(ne))]),_:1}),g[4]||(g[4]=i("导出数据 "))]),_:1})])]),e(Le,{statistics:n.value,onPeriodChange:V},null,8,["statistics"]),e(Je,{"order-counts":_.value,"active-status":w.value,"onUpdate:activeStatus":g[0]||(g[0]=k=>w.value=k)},null,8,["order-counts","active-status"]),e(Xe,{loading:D.value,orders:C.value,total:h.value,page:b.value,"onUpdate:page":g[1]||(g[1]=k=>b.value=k),"page-size":v.value,"onUpdate:pageSize":g[2]||(g[2]=k=>v.value=k),onView:l,onEdit:m,onDelete:$},null,8,["loading","orders","total","page","page-size"]),e(et,{visible:d.value,"onUpdate:visible":g[3]||(g[3]=k=>d.value=k),"order-data":t.value},null,8,["visible","order-data"])])}}},dt=N(lt,[["__scopeId","data-v-b32aef6f"]]);export{dt as default};
