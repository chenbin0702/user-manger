import{_ as ne,r as i,m as se,v as ue,a as s,o as u,c as _,e as f,b as l,w as a,F as R,d as S,f as p,u as I,C as $,g as v,t as z,q,p as y}from"./index-58786321.js";const ie={class:"ad-list"},de={class:"header"},re={class:"actions"},pe={class:"search-bar"},ce={key:1},me=["src"],ge={class:"dialog-footer"},ve={__name:"List",setup(_e){const b=i({position:"",status:""}),V=i(1),C=i(10),L=i(0),w=i([{id:1,name:"首页顶部横幅",type:"image"},{id:2,name:"侧边栏广告",type:"image"}]),N=i([{id:1,title:"新年促销活动",positionName:"首页顶部横幅",type:"image",content:"https://example.com/ad1.jpg",startTime:"2024-01-20 00:00:00",endTime:"2024-02-20 23:59:59",status:"投放中",clickCount:1256},{id:2,title:"限时优惠",positionName:"侧边栏广告",type:"image",content:"https://example.com/ad2.jpg",startTime:"2024-01-25 00:00:00",endTime:"2024-02-25 23:59:59",status:"已暂停",clickCount:856}]),m=i(!1),k=i(!1),x=i(null),n=i({title:"",positionId:"",timeRange:[],content:"",url:"",status:"投放中"}),E=se(()=>w.value.find(o=>o.id===n.value.positionId)),M={title:[{required:!0,message:"请输入广告标题",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],positionId:[{required:!0,message:"请选择广告位",trigger:"change"}],timeRange:[{required:!0,message:"请选择投放时间",trigger:"change"}],content:[{required:!0,message:"请上传广告内容",trigger:"change"}],url:[{required:!0,message:"请输入链接地址",trigger:"blur"},{type:"url",message:"请输入正确的URL地址",trigger:"blur"}]},D=o=>({投放中:"success",已暂停:"warning",已结束:"info"})[o]||"info",F=()=>{V.value=1},P=()=>{k.value=!1,n.value={title:"",positionId:"",timeRange:[],content:"",url:"",status:"投放中"},m.value=!0},j=o=>{k.value=!0,n.value={...o,timeRange:[new Date(o.startTime),new Date(o.endTime)]},m.value=!0},A=o=>{const e=o.status==="投放中"?"暂停":"启用";q.confirm(`确定要${e}广告 "${o.title}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y.success(`${e}成功`)})},W=o=>{q.confirm(`确定要删除广告 "${o.title}" 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y.success("删除成功")})},G=o=>{n.value.content=o.url},H=o=>{const e=o.type.startsWith("image/"),d=o.size/1024/1024<2;return e||y.error("只能上传图片文件!"),d||y.error("图片大小不能超过 2MB!"),e&&d},J=async()=>{x.value&&await x.value.validate(o=>{o&&(y.success(k.value?"更新成功":"创建成功"),m.value=!1)})},K=o=>{C.value=o},O=o=>{V.value=o};return ue(()=>{}),(o,e)=>{const d=s("el-option"),T=s("el-select"),c=s("el-button"),B=s("el-icon"),r=s("el-table-column"),Q=s("el-image"),X=s("el-tag"),Y=s("el-table"),Z=s("el-pagination"),U=s("el-input"),g=s("el-form-item"),ee=s("el-date-picker"),te=s("el-upload"),le=s("el-switch"),ae=s("el-form"),oe=s("el-dialog");return u(),_("div",ie,[f("div",de,[e[14]||(e[14]=f("h2",null,"广告内容管理",-1)),f("div",re,[f("div",pe,[l(T,{modelValue:b.value.position,"onUpdate:modelValue":e[0]||(e[0]=t=>b.value.position=t),placeholder:"广告位",clearable:"",class:"position-select"},{default:a(()=>[(u(!0),_(R,null,S(w.value,t=>(u(),v(d,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(T,{modelValue:b.value.status,"onUpdate:modelValue":e[1]||(e[1]=t=>b.value.status=t),placeholder:"状态",clearable:""},{default:a(()=>[l(d,{label:"投放中",value:"active"}),l(d,{label:"已暂停",value:"paused"}),l(d,{label:"已结束",value:"ended"})]),_:1},8,["modelValue"]),l(c,{type:"primary",onClick:F},{default:a(()=>e[12]||(e[12]=[p("搜索")])),_:1})]),l(c,{type:"primary",onClick:P},{default:a(()=>[l(B,null,{default:a(()=>[l(I($))]),_:1}),e[13]||(e[13]=p("新增广告 "))]),_:1})])]),l(Y,{data:N.value,style:{width:"100%"}},{default:a(()=>[l(r,{prop:"title",label:"广告标题","min-width":"150","show-overflow-tooltip":""}),l(r,{prop:"positionName",label:"广告位",width:"150"}),l(r,{label:"广告内容",width:"120"},{default:a(({row:t})=>[t.type==="image"?(u(),v(Q,{key:0,src:t.content,"preview-src-list":[t.content],fit:"cover",class:"ad-image"},null,8,["src","preview-src-list"])):(u(),_("span",ce,z(t.content),1))]),_:1}),l(r,{prop:"startTime",label:"开始时间",width:"180"}),l(r,{prop:"endTime",label:"结束时间",width:"180"}),l(r,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[l(X,{type:D(t.status)},{default:a(()=>[p(z(t.status),1)]),_:2},1032,["type"])]),_:1}),l(r,{prop:"clickCount",label:"点击量",width:"100",sortable:""}),l(r,{label:"操作",width:"250",fixed:"right"},{default:a(({row:t})=>[l(c,{size:"small",onClick:h=>j(t)},{default:a(()=>e[15]||(e[15]=[p("编辑")])),_:2},1032,["onClick"]),l(c,{size:"small",type:t.status==="投放中"?"warning":"success",onClick:h=>A(t)},{default:a(()=>[p(z(t.status==="投放中"?"暂停":"启用"),1)]),_:2},1032,["type","onClick"]),l(c,{size:"small",type:"danger",onClick:h=>W(t)},{default:a(()=>e[16]||(e[16]=[p(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(Z,{"current-page":V.value,"onUpdate:currentPage":e[2]||(e[2]=t=>V.value=t),"page-size":C.value,"onUpdate:pageSize":e[3]||(e[3]=t=>C.value=t),total:L.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",class:"pagination",onSizeChange:K,onCurrentChange:O},null,8,["current-page","page-size","total"]),l(oe,{modelValue:m.value,"onUpdate:modelValue":e[11]||(e[11]=t=>m.value=t),title:k.value?"编辑广告":"新增广告",width:"600px"},{footer:a(()=>[f("span",ge,[l(c,{onClick:e[10]||(e[10]=t=>m.value=!1)},{default:a(()=>e[17]||(e[17]=[p("取消")])),_:1}),l(c,{type:"primary",onClick:J},{default:a(()=>e[18]||(e[18]=[p("确定")])),_:1})])]),default:a(()=>[l(ae,{ref_key:"formRef",ref:x,model:n.value,rules:M,"label-width":"100px"},{default:a(()=>[l(g,{label:"广告标题",prop:"title"},{default:a(()=>[l(U,{modelValue:n.value.title,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.title=t),placeholder:"请输入广告标题"},null,8,["modelValue"])]),_:1}),l(g,{label:"广告位",prop:"positionId"},{default:a(()=>[l(T,{modelValue:n.value.positionId,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.positionId=t),placeholder:"请选择广告位",style:{width:"100%"}},{default:a(()=>[(u(!0),_(R,null,S(w.value,t=>(u(),v(d,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(g,{label:"投放时间",prop:"timeRange"},{default:a(()=>[l(ee,{modelValue:n.value.timeRange,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value.timeRange=t),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(g,{label:"广告内容",prop:"content"},{default:a(()=>{var t;return[((t=E.value)==null?void 0:t.type)==="image"?(u(),v(te,{key:0,class:"content-uploader",action:"/api/upload","show-file-list":!1,"on-success":G,"before-upload":H},{default:a(()=>[n.value.content?(u(),_("img",{key:0,src:n.value.content,class:"content-image"},null,8,me)):(u(),v(B,{key:1,class:"content-uploader-icon"},{default:a(()=>[l(I($))]),_:1}))]),_:1})):(u(),v(U,{key:1,modelValue:n.value.content,"onUpdate:modelValue":e[7]||(e[7]=h=>n.value.content=h),type:"textarea",rows:3,placeholder:"请输入广告内容"},null,8,["modelValue"]))]}),_:1}),l(g,{label:"链接地址",prop:"url"},{default:a(()=>[l(U,{modelValue:n.value.url,"onUpdate:modelValue":e[8]||(e[8]=t=>n.value.url=t),placeholder:"请输入链接地址"},null,8,["modelValue"])]),_:1}),l(g,{label:"状态",prop:"status"},{default:a(()=>[l(le,{modelValue:n.value.status,"onUpdate:modelValue":e[9]||(e[9]=t=>n.value.status=t),"active-value":"投放中","inactive-value":"已暂停"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ye=ne(ve,[["__scopeId","data-v-75c13280"]]);export{ye as default};
